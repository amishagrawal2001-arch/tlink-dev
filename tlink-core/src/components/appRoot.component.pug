title-bar(
  *ngIf='ready && !hostWindow.isFullscreen && config.store.appearance.dock == "off" && isTitleBarNeeded()',
  (dblclick)='toggleMaximize()',
  [hideControls]='hostApp.platform !== Platform.Linux && !hostWindow.isFullscreen',
  [class.inset]='hostApp.platform == Platform.macOS && !hostWindow.isFullscreen'
)

.content.has-left-dock(
    *ngIf='ready',
    [class.tabs-on-top]='config.store.appearance.tabsLocation == "top" || config.store.appearance.tabsLocation == "left" || config.store.appearance.tabsLocation == "right"',
    [class.tabs-on-left]='hasVerticalTabs() && config.store.appearance.tabsLocation == "left"',
    [class.tabs-titlebar-enabled]='isTitleBarNeeded()',
    [class.tabs-on-right]='hasVerticalTabs() && config.store.appearance.tabsLocation == "right"',
    [class.has-right-dock]='sidePanels.length'
)
    .left-dock
        .left-dock-section
            button.left-dock-button(
                type='button',
                (click)='openProfileSelector()',
                ngbTooltip='Profiles'
            ) !{require('../icons/profiles.svg')}
            button.left-dock-button(
                type='button',
                (click)='openCodeEditor()',
                ngbTooltip='Code editor'
            ) !{require('../icons/code.svg')}
            button.left-dock-button(
                type='button',
                (click)='openAIChat()',
                ngbTooltip='AI Chat'
            )
                i.fas.fa-comments
        .left-dock-section.left-dock-bottom
            button.left-dock-button(
                type='button',
                (click)='openSettingsFromDock()',
                ngbTooltip='Settings'
            )
                i.fas.fa-cog
            button.left-dock-button(
                type='button',
                (click)='cycleColorSchemeFromDock()',
                ngbTooltip='Switch color scheme'
            ) !{require('../icons/color-scheme.svg')}
    .right-dock(*ngIf='sidePanels.length')
        .side-panel-tabs
            button.side-panel-toggle(
                *ngFor='let panel of sidePanels',
                type='button',
                (click)='toggleSidePanel(panel)',
                (contextmenu)='openSidePanelMenu($event, panel)',
                (mouseup)='onSidePanelMouseUp($event, panel)',
                [class.is-open]='sidePanelVisible && sidePanelId === panel.id',
                [ngbTooltip]='panel.label',
                [attr.aria-label]='panel.label',
                [style.--side-panel-accent-rgb]='getSidePanelAccentRgb(panel)'
            )
                span {{panel.label}}
    .tab-bar(
        *ngIf='!hostWindow.isFullscreen || config.store.appearance.tabsInFullscreen',
        [class.tab-bar-no-controls-overlay]='hostApp.platform == Platform.macOS',
        (dblclick)='!isTitleBarNeeded() && toggleMaximize()'
    )
        .inset.background(*ngIf='hostApp.platform == Platform.macOS \
        && !hostWindow.isFullscreen \
        && config.store.appearance.frame == "thin" \
        && (config.store.appearance.tabsLocation == "top" || config.store.appearance.tabsLocation == "left")')
        .tabs(
            cdkDropList,
            [cdkDropListOrientation]='(config.store.appearance.tabsLocation == "top" || config.store.appearance.tabsLocation == "bottom") ? "horizontal" : "vertical"',
            (cdkDropListDropped)='onTabsReordered($event)',
            cdkAutoDropGroup='app-tabs'
        )
            tab-header(
                *ngFor='let tab of app.tabs; let idx = index',
                [index]='idx',
                [tab]='tab',
                [active]='tab == app.activeTab',
                [@animateTab]='{value: "in", params: {size: targetTabSize}}',
                [@.disabled]='hasVerticalTabs() || !config.store.accessibility.animations',
                (click)='app.selectTab(tab)',
                [class.fully-draggable]='hostApp.platform !== Platform.macOS',
                [ngbTooltip]='tab.customTitle || tab.title'
            )

        .btn-group.background
            .d-flex(
                *ngFor='let button of leftToolbarButtons'
            )
                button.btn.btn-secondary.btn-tab-bar(
                    [ngbTooltip]='button.label',
                    (click)='button.run && button.run()',
                    [fastHtmlBind]='button.icon'
                )

            .d-flex(
                ngbDropdown,
                container='body',
                [autoClose]='false',
                [display]='transfersFloating ? "static" : "dynamic"',
                #activeTransfersDropdown='ngbDropdown'
            )
                button.btn.btn-secondary.btn-tab-bar(
                    [hidden]='activeTransfers.length == 0',
                    [ngbTooltip]='"File transfers"|translate',
                    [class.btn-transfer-active]='activeTransfers.length > 0',
                    ngbDropdownToggle
                ) !{require('../icons/transfers.svg')}
                transfers-menu(
                    ngbDropdownMenu,
                    [(transfers)]='activeTransfers',
                    (transfersChange)='onTransfersChange()',
                    (floatingChange)='onTransfersFloatingChange($event)'
                )

        .btn-space.background(
            [class.persistent]='config.store.appearance.frame == "thin"',
            [class.drag]='config.store.appearance.frame == "thin" \
            && ((config.store.appearance.tabsLocation !== "left" && config.store.appearance.tabsLocation !== "right") || hostApp.platform !== Platform.macOS)'
        )

        .btn-group.background
            .d-flex(
                *ngFor='let button of rightToolbarButtons'
            )
                button.btn.btn-secondary.btn-tab-bar(
                    [ngbTooltip]='button.label',
                    (click)='button.run && button.run()',
                    [fastHtmlBind]='button.icon'
                )

            button.btn.btn-secondary.btn-tab-bar.btn-update(
                *ngIf='updatesAvailable',
                [ngbTooltip]='"Update available - Click to install"|translate',
                (click)='updater.update()'
            ) !{require('../icons/gift.svg')}

        window-controls.background(
            *ngIf='config.store.appearance.frame == "thin" \
            && config.store.appearance.tabsLocation !== "left" \
            && config.store.appearance.tabsLocation !== "right" \
            && hostApp.platform == Platform.Linux',
        )

        div.window-controls-spacer(
            *ngIf='config.store.appearance.frame == "thin" && (hostApp.platform == Platform.Windows) && (config.store.appearance.tabsLocation == "top")',
        )
    .content-body([class.has-side-panel-tabs]='sidePanels.length')
        .workspace-stack
            .workspace
                .workspace-main
                    start-page.content-tab.content-tab-active(*ngIf='ready && app.tabs.length == 0')

                    tab-body.content-tab(
                        #tabBodies,
                        *ngFor='let tab of unsortedTabs',
                        [class.content-tab-active]='tab == app.activeTab',
                        [active]='tab == app.activeTab',
                        [tab]='tab',
                    )
                .side-panel(*ngIf='sidePanelVisible && sidePanelComponent', [style.width.px]='sidePanelWidth')
                    ng-container(*ngComponentOutlet='sidePanelComponent')
        .bottom-panel(*ngIf='shouldShowBottomPanel', [style.height.px]='bottomPanelHeight')
            .bottom-panel-resizer(
                (mousedown)='onBottomResizeStart($event)',
                (touchstart)='onBottomResizeStart($event)'
            )
            ng-container(*ngComponentOutlet='bottomPanelComponent', [ngComponentOutletInputs]='bottomPanelInputs')
        .shortcut-bar
            .shortcut-actions
                button.btn.btn-sm.btn-icon.shortcut-icon-button(
                    type='button',
                    [disabled]='!canSplitShortcut',
                    ngbTooltip='Split active session',
                    (click)='openSplitShortcutMenu($event)'
                )
                    svg(width='14', height='14', viewBox='0 0 16 16', aria-hidden='true', focusable='false')
                        rect(x='2', y='3', width='5', height='10', rx='1', ry='1', fill='none', stroke='currentColor', stroke-width='1.2')
                        rect(x='9', y='3', width='5', height='10', rx='1', ry='1', fill='none', stroke='currentColor', stroke-width='1.2')
                        line(x1='7.5', y1='2', x2='7.5', y2='14', stroke='currentColor', stroke-width='1.2', stroke-linecap='round')
                button.btn.btn-sm.btn-icon.shortcut-icon-button(
                    type='button',
                    [disabled]='!canOpenCommandWindow',
                    [class.active]='isCommandWindowOpen',
                    ngbTooltip='Command window',
                    (click)='toggleCommandWindowBottom()'
                )
                    svg(width='14', height='14', viewBox='0 0 16 16', aria-hidden='true', focusable='false')
                        rect(x='1.5', y='2.5', width='13', height='11', rx='1.5', ry='1.5', fill='none', stroke='currentColor', stroke-width='1.2')
                        polyline(points='4,5.5 6.5,8 4,10.5', fill='none', stroke='currentColor', stroke-width='1.2', stroke-linecap='round', stroke-linejoin='round')
                        line(x1='7.5', y1='10.5', x2='12', y2='10.5', stroke='currentColor', stroke-width='1.2', stroke-linecap='round')
ng-template(ngbModalContainer)
